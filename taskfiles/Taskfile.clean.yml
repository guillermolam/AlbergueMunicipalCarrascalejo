version: "3"

tasks:
  frontend:
    desc: Clean frontend using centralized script
    cmds:
      - echo "ðŸ§¹ Cleaning frontend via centralized script..."
      - ./scripts/clean-frontend.sh frontend
      - echo "âœ… Frontend cleaned"

  auth_service:
    desc: Clean auth service frontend using centralized script
    cmds:
      - echo "ðŸ§¹ Cleaning auth service frontend via centralized script..."
      - ./scripts/clean-frontend.sh backend/auth-service
      - echo "âœ… Auth service frontend cleaned"

  fmt:
    desc: Format code using package.json scripts
    cmds:
      - echo "ðŸ–¥ï¸  Formatting code..."
      - cd frontend && npm run fmt || bun run fmt || echo "âš ï¸  No fmt script found"
      - cd backend/auth-service && npm run fmt || bun run fmt || echo "âš ï¸  No fmt script found"
      - echo "âœ… Code formatted"

  lint:
    desc: Lint code using package.json scripts
    cmds:
      - echo "ðŸ”  Linting code..."
      - cd frontend && npm run lint || bun run lint || echo "âš ï¸  No lint script found"
      - cd backend/auth-service && npm run lint || bun run lint || echo "âš ï¸  No lint script found"
      - echo "âœ… Code linted"

  lint:fix:
    desc: Fix linting issues using package.json scripts
    cmds:
      - echo "ðŸ”§  Fixing linting issues..."
      - cd frontend && npm run lint:fix || bun run lint:fix || echo "âš ï¸  No lint:fix script found"
      - cd backend/auth-service && npm run lint:fix || bun run lint:fix || echo "âš ï¸  No lint:fix script found"
      - echo "âœ… Linting issues fixed"

  node_modules:
    desc: Remove node_modules directories using centralized script
    cmds:
      - echo "ðŸ§¹ Removing node_modules..."
      - rm -rf frontend/node_modules 2>/dev/null || echo "âš ï¸  Could not remove some node_modules files"
      - rm -rf backend/auth-service/node_modules 2>/dev/null || echo "âš ï¸  Could not remove some node_modules files"
      - echo "âœ… node_modules cleanup completed"

  all_targets:
    desc: Force clean all target directories using centralized script
    cmds:
      - echo "ðŸ”¥ Force cleaning all target directories..."
      - ./scripts/clean-rust.sh .
      - ./scripts/clean-rust.sh backend
      - find backend -name "target" -type d -exec rm -rf {} + 2>/dev/null || true
      - echo "âœ… All target directories cleaned"

  main:
    desc: Clean development environment using centralized script
    cmds:
      - echo "ðŸ§¹ Cleaning development environment..."
      - ./scripts/clean-all.sh rust
      - echo "âœ… Development environment cleaned"

  default:
    desc: Clean build artifacts and stop all services using centralized script
    cmds:
      - echo "ðŸ§¹ Starting comprehensive cleanup..."
      - ./scripts/clean-all.sh all
      - echo "ðŸŽ‰ Development environment fully cleaned"