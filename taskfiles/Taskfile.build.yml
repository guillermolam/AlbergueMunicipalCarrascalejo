# Taskfile para construccion de servicios

version: "3"

vars:
  SCRIPTS_DIR: scripts/build

tasks:
  all:
    desc: Construye todos los servicios
    cmds:
      - task: build:frontend
      - task: build:backend
      - task: build:gateway

  frontend:
    desc: Construye el frontend
    dir: frontend
    cmds:
      - echo "Construyendo frontend..."
      - bun run build

  backend:
    desc: Construye todos los servicios del backend
    cmds:
      - echo "Construyendo servicios del backend..."
      - bash {{.SCRIPTS_DIR}}/build-backend.sh

  gateway:
    desc: Construye el gateway
    dir: gateway
    cmds:
      - echo "Construyendo gateway..."
      - spin build

  clean:
    desc: Limpia todos los builds
    cmds:
      - echo "Limpiando builds..."
      - bash {{.SCRIPTS_DIR}}/clean-builds.sh || true
      - cargo clean || true
      - rm -rf frontend/dist || true
